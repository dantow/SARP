{"ast":null,"code":"var _jsxFileName = \"/home/rnorbert/IdeaProjects/SARP/sarp/src/components/map/MapBox.jsx\",\n  _s = $RefreshSig$();\nimport './MapBox.css';\nimport mapboxgl from 'mapbox-gl';\nimport 'mapbox-gl-geocoder/dist/mapbox-gl-geocoder.css';\nimport { useEffect } from 'react';\nimport haversineDistance from './helpers/haversine';\nimport { initializeMap, addGeocoder, drawRoute } from './helpers/mapInitializer';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst token = 'pk.eyJ1Ijoibm9yZGJlcmciLCJhIjoiY2xudm14NDFoMDB1MzJqb2JnbHFnZ2F2NSJ9.87wgkopxDP_D8B-OkI11LQ';\nmapboxgl.accessToken = token;\nfunction MapBox() {\n  _s();\n  let placeMarker = false;\n  let routeType = 'walking';\n  let markers = [];\n  let markersToRemove = [];\n  let map;\n  let routeDetails;\n  function changeRouteType(type) {\n    routeType = type;\n  }\n  function changeMarkerPlacerState() {\n    placeMarker = !placeMarker;\n  }\n  function removeMarkers(list) {\n    list.forEach(element => {\n      element.remove();\n    });\n    markers = markers.filter(item => !list.includes(item));\n  }\n  function addMarker(coordinates) {\n    if (placeMarker) {\n      const maximumNumberOfMarkers = 25;\n      if (markers.length <= maximumNumberOfMarkers) {\n        markers.push(new mapboxgl.Marker().setDraggable(true).setLngLat([coordinates.lng, coordinates.lat]).addTo(map));\n      }\n    } else {\n      markersToRemove = markers.filter(marker => haversineDistance(marker.getLngLat().lat, marker.getLngLat().lng, coordinates.lat, coordinates.lng) < 30);\n      removeMarkers(markersToRemove);\n    }\n  }\n  async function retrieveDirection() {\n    const coordinates = markers.map(marker => marker.getLngLat().lng + ',' + marker.getLngLat().lat).join(';', ',');\n    const response = await fetch(`https://api.mapbox.com/directions/v5/mapbox/${routeType}/${coordinates}\n      ?annotations=distance,duration&overview=full&geometries=geojson&access_token=${token}`);\n    routeDetails = await response.json();\n    drawRoute(await routeDetails.routes[0], map);\n  }\n  function loadMap() {\n    map = initializeMap(addMarker);\n    addGeocoder(map, addMarker);\n  }\n  useEffect(() => {\n    loadMap();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"box\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      children: [/*#__PURE__*/_jsxDEV(\"meta\", {\n        name: \"viewport\",\n        content: \"initial-scale=1,maximum-scale=1,user-scalable=no\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"link\", {\n        href: \"https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css\",\n        rel: \"stylesheet\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"settings\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Place marker\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            onClick: () => changeMarkerPlacerState()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"planner\",\n          children: \"Route by:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"routes\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Traffic\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            onClick: () => changeRouteType('driving-traffic')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Driving\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            onClick: () => changeRouteType('driving')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Walking\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            onClick: () => changeRouteType('walking')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Cycling\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            onClick: () => changeRouteType('cycling')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"plan-route-button\",\n          onClick: () => retrieveDirection(),\n          children: \"Plan route \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"map\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"instructions\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n}\n_s(MapBox, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n_c = MapBox;\nexport default MapBox;\nvar _c;\n$RefreshReg$(_c, \"MapBox\");","map":{"version":3,"names":["mapboxgl","useEffect","haversineDistance","initializeMap","addGeocoder","drawRoute","jsxDEV","_jsxDEV","token","accessToken","MapBox","_s","placeMarker","routeType","markers","markersToRemove","map","routeDetails","changeRouteType","type","changeMarkerPlacerState","removeMarkers","list","forEach","element","remove","filter","item","includes","addMarker","coordinates","maximumNumberOfMarkers","length","push","Marker","setDraggable","setLngLat","lng","lat","addTo","marker","getLngLat","retrieveDirection","join","response","fetch","json","routes","loadMap","className","children","name","content","fileName","_jsxFileName","lineNumber","columnNumber","href","rel","onClick","id","_c","$RefreshReg$"],"sources":["/home/rnorbert/IdeaProjects/SARP/sarp/src/components/map/MapBox.jsx"],"sourcesContent":["import './MapBox.css'\nimport mapboxgl from 'mapbox-gl'\nimport 'mapbox-gl-geocoder/dist/mapbox-gl-geocoder.css'\nimport { useEffect } from 'react'\nimport haversineDistance from './helpers/haversine'\nimport { initializeMap, addGeocoder, drawRoute } from './helpers/mapInitializer'\n\nconst token = 'pk.eyJ1Ijoibm9yZGJlcmciLCJhIjoiY2xudm14NDFoMDB1MzJqb2JnbHFnZ2F2NSJ9.87wgkopxDP_D8B-OkI11LQ'\nmapboxgl.accessToken = token\n\nfunction MapBox () {\n  let placeMarker = false\n  let routeType = 'walking'\n  let markers = []\n  let markersToRemove = []\n  let map\n  let routeDetails\n\n  function changeRouteType (type) {\n    routeType = type\n  }\n\n  function changeMarkerPlacerState () {\n    placeMarker = !placeMarker\n  }\n\n  function removeMarkers (list) {\n    list.forEach(element => {\n      element.remove()\n    })\n    markers = markers.filter(item => !list.includes(item))\n  }\n\n  function addMarker (coordinates) {\n    if (placeMarker) {\n      const maximumNumberOfMarkers = 25\n      if (markers.length <= maximumNumberOfMarkers) {\n        markers.push(new mapboxgl.Marker()\n          .setDraggable(true)\n          .setLngLat([coordinates.lng, coordinates.lat])\n          .addTo(map)\n        )\n      }\n    } else {\n      markersToRemove = markers.filter(marker =>\n        haversineDistance(marker.getLngLat().lat, marker.getLngLat().lng, coordinates.lat, coordinates.lng) < 30)\n\n      removeMarkers(markersToRemove)\n    }\n  }\n\n  async function retrieveDirection () {\n    const coordinates = markers.map(\n      (marker) => marker.getLngLat().lng + ',' + marker.getLngLat().lat)\n      .join(';', ',')\n\n    const response = await fetch(\n      `https://api.mapbox.com/directions/v5/mapbox/${routeType}/${coordinates}\n      ?annotations=distance,duration&overview=full&geometries=geojson&access_token=${token}`)\n\n    routeDetails = await response.json()\n    drawRoute(await routeDetails.routes[0], map)\n  }\n\n  function loadMap () {\n    map = initializeMap(addMarker)\n    addGeocoder(map, addMarker)\n  }\n\n  useEffect(() => {\n    loadMap()\n  }, [])\n\n  return (\n    <div className='box'>\n      <header>\n        <meta name=\"viewport\" content=\"initial-scale=1,maximum-scale=1,user-scalable=no\"/>\n        <link href='https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css' rel='stylesheet' />\n      </header>\n      <div>\n        <div className='settings'>\n          <div>\n            <label>Place marker</label>\n            <input type='checkbox' onClick={() => changeMarkerPlacerState()}/>\n          </div>\n          <div className='planner'>Route by:</div>\n          <div className='routes'>\n            <label>Traffic</label>\n            <input type='checkbox' onClick={ () => changeRouteType('driving-traffic')}/>\n            <label>Driving</label>\n            <input type='checkbox' onClick={() => changeRouteType('driving')}/>\n            <label>Walking</label>\n            <input type='checkbox' onClick={() => changeRouteType('walking')}/>\n            <label>Cycling</label>\n            <input type='checkbox' onClick={() => changeRouteType('cycling')}/>\n          </div>\n          <button id='plan-route-button' onClick={() => retrieveDirection()}>Plan route </button>\n        </div>\n        <div id=\"map\"></div>\n        <div id=\"instructions\" ></div>\n        <div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default MapBox\n"],"mappings":";;AAAA,OAAO,cAAc;AACrB,OAAOA,QAAQ,MAAM,WAAW;AAChC,OAAO,gDAAgD;AACvD,SAASC,SAAS,QAAQ,OAAO;AACjC,OAAOC,iBAAiB,MAAM,qBAAqB;AACnD,SAASC,aAAa,EAAEC,WAAW,EAAEC,SAAS,QAAQ,0BAA0B;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAEhF,MAAMC,KAAK,GAAG,4FAA4F;AAC1GR,QAAQ,CAACS,WAAW,GAAGD,KAAK;AAE5B,SAASE,MAAMA,CAAA,EAAI;EAAAC,EAAA;EACjB,IAAIC,WAAW,GAAG,KAAK;EACvB,IAAIC,SAAS,GAAG,SAAS;EACzB,IAAIC,OAAO,GAAG,EAAE;EAChB,IAAIC,eAAe,GAAG,EAAE;EACxB,IAAIC,GAAG;EACP,IAAIC,YAAY;EAEhB,SAASC,eAAeA,CAAEC,IAAI,EAAE;IAC9BN,SAAS,GAAGM,IAAI;EAClB;EAEA,SAASC,uBAAuBA,CAAA,EAAI;IAClCR,WAAW,GAAG,CAACA,WAAW;EAC5B;EAEA,SAASS,aAAaA,CAAEC,IAAI,EAAE;IAC5BA,IAAI,CAACC,OAAO,CAACC,OAAO,IAAI;MACtBA,OAAO,CAACC,MAAM,CAAC,CAAC;IAClB,CAAC,CAAC;IACFX,OAAO,GAAGA,OAAO,CAACY,MAAM,CAACC,IAAI,IAAI,CAACL,IAAI,CAACM,QAAQ,CAACD,IAAI,CAAC,CAAC;EACxD;EAEA,SAASE,SAASA,CAAEC,WAAW,EAAE;IAC/B,IAAIlB,WAAW,EAAE;MACf,MAAMmB,sBAAsB,GAAG,EAAE;MACjC,IAAIjB,OAAO,CAACkB,MAAM,IAAID,sBAAsB,EAAE;QAC5CjB,OAAO,CAACmB,IAAI,CAAC,IAAIjC,QAAQ,CAACkC,MAAM,CAAC,CAAC,CAC/BC,YAAY,CAAC,IAAI,CAAC,CAClBC,SAAS,CAAC,CAACN,WAAW,CAACO,GAAG,EAAEP,WAAW,CAACQ,GAAG,CAAC,CAAC,CAC7CC,KAAK,CAACvB,GAAG,CACZ,CAAC;MACH;IACF,CAAC,MAAM;MACLD,eAAe,GAAGD,OAAO,CAACY,MAAM,CAACc,MAAM,IACrCtC,iBAAiB,CAACsC,MAAM,CAACC,SAAS,CAAC,CAAC,CAACH,GAAG,EAAEE,MAAM,CAACC,SAAS,CAAC,CAAC,CAACJ,GAAG,EAAEP,WAAW,CAACQ,GAAG,EAAER,WAAW,CAACO,GAAG,CAAC,GAAG,EAAE,CAAC;MAE3GhB,aAAa,CAACN,eAAe,CAAC;IAChC;EACF;EAEA,eAAe2B,iBAAiBA,CAAA,EAAI;IAClC,MAAMZ,WAAW,GAAGhB,OAAO,CAACE,GAAG,CAC5BwB,MAAM,IAAKA,MAAM,CAACC,SAAS,CAAC,CAAC,CAACJ,GAAG,GAAG,GAAG,GAAGG,MAAM,CAACC,SAAS,CAAC,CAAC,CAACH,GAAG,CAAC,CACjEK,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC;IAEjB,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CACzB,+CAA8ChC,SAAU,IAAGiB,WAAY;AAC9E,qFAAqFtB,KAAM,EAAC,CAAC;IAEzFS,YAAY,GAAG,MAAM2B,QAAQ,CAACE,IAAI,CAAC,CAAC;IACpCzC,SAAS,CAAC,MAAMY,YAAY,CAAC8B,MAAM,CAAC,CAAC,CAAC,EAAE/B,GAAG,CAAC;EAC9C;EAEA,SAASgC,OAAOA,CAAA,EAAI;IAClBhC,GAAG,GAAGb,aAAa,CAAC0B,SAAS,CAAC;IAC9BzB,WAAW,CAACY,GAAG,EAAEa,SAAS,CAAC;EAC7B;EAEA5B,SAAS,CAAC,MAAM;IACd+C,OAAO,CAAC,CAAC;EACX,CAAC,EAAE,EAAE,CAAC;EAEN,oBACEzC,OAAA;IAAK0C,SAAS,EAAC,KAAK;IAAAC,QAAA,gBAClB3C,OAAA;MAAA2C,QAAA,gBACE3C,OAAA;QAAM4C,IAAI,EAAC,UAAU;QAACC,OAAO,EAAC;MAAkD;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAC,CAAC,eAClFjD,OAAA;QAAMkD,IAAI,EAAC,2DAA2D;QAACC,GAAG,EAAC;MAAY;QAAAL,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACpF,CAAC,eACTjD,OAAA;MAAA2C,QAAA,gBACE3C,OAAA;QAAK0C,SAAS,EAAC,UAAU;QAAAC,QAAA,gBACvB3C,OAAA;UAAA2C,QAAA,gBACE3C,OAAA;YAAA2C,QAAA,EAAO;UAAY;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAC3BjD,OAAA;YAAOY,IAAI,EAAC,UAAU;YAACwC,OAAO,EAAEA,CAAA,KAAMvC,uBAAuB,CAAC;UAAE;YAAAiC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC/D,CAAC,eACNjD,OAAA;UAAK0C,SAAS,EAAC,SAAS;UAAAC,QAAA,EAAC;QAAS;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC,eACxCjD,OAAA;UAAK0C,SAAS,EAAC,QAAQ;UAAAC,QAAA,gBACrB3C,OAAA;YAAA2C,QAAA,EAAO;UAAO;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACtBjD,OAAA;YAAOY,IAAI,EAAC,UAAU;YAACwC,OAAO,EAAGA,CAAA,KAAMzC,eAAe,CAAC,iBAAiB;UAAE;YAAAmC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAC,CAAC,eAC5EjD,OAAA;YAAA2C,QAAA,EAAO;UAAO;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACtBjD,OAAA;YAAOY,IAAI,EAAC,UAAU;YAACwC,OAAO,EAAEA,CAAA,KAAMzC,eAAe,CAAC,SAAS;UAAE;YAAAmC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAC,CAAC,eACnEjD,OAAA;YAAA2C,QAAA,EAAO;UAAO;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACtBjD,OAAA;YAAOY,IAAI,EAAC,UAAU;YAACwC,OAAO,EAAEA,CAAA,KAAMzC,eAAe,CAAC,SAAS;UAAE;YAAAmC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAC,CAAC,eACnEjD,OAAA;YAAA2C,QAAA,EAAO;UAAO;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACtBjD,OAAA;YAAOY,IAAI,EAAC,UAAU;YAACwC,OAAO,EAAEA,CAAA,KAAMzC,eAAe,CAAC,SAAS;UAAE;YAAAmC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAChE,CAAC,eACNjD,OAAA;UAAQqD,EAAE,EAAC,mBAAmB;UAACD,OAAO,EAAEA,CAAA,KAAMjB,iBAAiB,CAAC,CAAE;UAAAQ,QAAA,EAAC;QAAW;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpF,CAAC,eACNjD,OAAA;QAAKqD,EAAE,EAAC;MAAK;QAAAP,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eACpBjD,OAAA;QAAKqD,EAAE,EAAC;MAAc;QAAAP,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC,eAC9BjD,OAAA;QAAA8C,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACK,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAAC7C,EAAA,CA/FQD,MAAM;AAAAmD,EAAA,GAANnD,MAAM;AAiGf,eAAeA,MAAM;AAAA,IAAAmD,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}